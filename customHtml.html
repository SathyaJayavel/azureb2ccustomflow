<html>

<head>

</head>

<body>
    <script>
        const url = 'https://gentle-pocket.cyclic.app/users'
        async function getForm() {
            fetch(url).then(result => {
                return result.json()
            }).then(data => {
                let result = {};
                let markup = ``;
                data.questions.forEach(ques => {
                    if (ques.answerType === 'dropDown') {
                        let optionMarkup = ques.hasDefault ? `<option value="value" selected>${ques.defaultValue}</option>` : ``;
                        if (ques.options && ques.options.length > 0) {
                            ques.options.forEach(option => {
                                optionMarkup += `<option value="${option}">${option}</option>`
                            })
                        }
                        markup += `<label for="${ques.id}">${ques.question}</label>
                        <select id="${ques.id}" name="${ques.id}">
                           ${optionMarkup}
                        </select><br>`;
                    }
                });
                document.querySelector('form').insertAdjacentHTML('afterbegin', markup);
            }
            )
        }
        getForm();
        const button = document.getElementById('post-btn');

        button.addEventListener('click', async _ => {
            try {

                const data = new FormData(event.target);

                const value = Object.fromEntries(data.entries());

                const response = await fetch('https://gentle-pocket.cyclic.app/users', {
                    method: 'post',
                    body: {
                        "data": value
                    }
                });
                console.log('Completed!', response);
            } catch (err) {
                console.error(`Error: ${err}`);
            }
        });

    </script>
    <form>
        <button id="post-btn">Submit</button>
    </form>
    <div id="api"></div>
</body>

</html>